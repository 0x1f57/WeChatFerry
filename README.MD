# WeChatFerry
传送信息往返微信的摆渡车。更多介绍见：[微信机器人 DIY 从 0 到 1](https://mp.weixin.qq.com/s/c4ntj-7NTmbpSfF8df6dIw)。

欢迎加群交流，后台回复 `WeChatFerry `：

![碲矿](碲矿.jpeg)

## 快速开始
1. 使用 VS2019 编译。
2. 打开 `CMD`，运行 `App.exe`

## 项目结构
### Spy
间谍模块，注入到微信中，通过 RPC 做消息转发工作。

### SDK
RPC 的客户端，封装接口，供其他方调用。

### SDKpy
用于生成 Python 接口。为编译该项目，需要做一些配置：
1. 添加附加包含目录
* Python 头：`C:\Program Files (x86)\Python37-32\Include`
* Pybind11 头：`C:\Projs\.pyenv\pybind11\lib\site-packages\pybind11\include`
*注*：
    1. pybind11 可以通过 Python 安装（本工程安装到虚拟环境里了）：`pip install pybind11`
    2. 然后通过命令查找：`python -m pybind11 --includes`

2. 添加 Python 的库
* `C:\Program Files (x86)\Python37-32\libs`

### App
示例应用，介绍如何调用 SDK。

## 版本更新
### v3.7.0.30-7（2022.09.24）
修复群聊有系统消息时会崩溃 bug。后续考虑把消息来源交还给客户端自己区别。

### v3.7.0.30-6（2022.08.21）
* 通过好友验证

### v3.7.0.30-5（2022.08.20）
* 执行 SQL 语句

### v3.7.0.30-4（2022.08.20）
修复群消息 @人 功能。有几点注意事项：
1. `vAtWxids` 是要 `@` 的 `wxid` 清单，以 `,` 分隔。
2. 只有群主才能 `@所有人`，非群主硬发 `@所有人` 会导致消息发不出去；`@所有人` 对应 `vAtWxids` 为 `"notify@all"`。
3. 消息体里 `@` 的数量必须与 `vAtWxids` 里的数量一致，否则消息能发出但 `@` 功能失效。

### v3.7.0.30-3（2022.08.20）
修复可重入 bug。

### v3.7.0.30-2（2022.08.14）
优化 Hook 和 Inject 代码，实现可重入。

### v3.7.0.30-1（2022.08.12）
适配微信 `3.7.0.30`。

### v3.7.0.29-3（2022.08.7）
* 查询数据库，获取库、表。

### v3.7.0.29-2（2022.08.7）
优化 RPC。

### v3.7.0.29-1（2022.08.7）
适配微信 `3.7.0.29`。

### v3.3.0.115-3（2021.08.28）
适配微信 `3.3.0.115`，新增功能：
* 获取所有联系人

### v3.3.0.115-2（2021.08.22）
适配微信 `3.3.0.115`，新增功能：
* 发送图片消息

### v3.3.0.115-1（2021.08.22）
适配微信 `3.3.0.115`。

### v3.0.0.57-1（2021.02.12）
适配微信 `3.0.0.57`，支持功能：
* 登录状态判断
* 接收文本消息
* 发送文本消息
